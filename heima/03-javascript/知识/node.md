## node是什么
node可以搭建服务端(服务器、后端)

使用js编写后端程序

现在我们一般用来前端工程化
下面那个多的 只有一行的 就是工程化的 
![11011](../images/11月/11-01/1.png){width=600px}

浏览器和node.js有一部分相同的地方 也有一部分不同的地方
中间的两个都有 两边各自有 

比如node.js没有dom bom

而浏览器没有node里的一些内容
![11012](../images//11月/11-01/2.png){width=600px}

url可以输入版本号
![11013](../images//11月/11-01/3.png){width=600px}

msi程序下载即可
![11014](../images//11月/11-01/4.png){width=600px}

![11015](../images//11月/11-01/5.png){width=600px}

## 尽可能不要使用PowerShell
有可能要用管理员权限的地方会不行 还是用cmd管理员命令行会好一点

## node使用
![11016](../images//11月/11-01/6.png){width=600px}

在.js文件中书写完js代码后 我一般控制台运行

可是这里不行 而跑到文件目录栏cmd 或者cmd找路径太麻烦

所以使用点击文件右键 选择使用 在集成终端中显示即可 
这样会找到这个文件的对于路径
![11017](../images//11月/11-01/7.png){width=500px}

## node使用.js文件代码
![11018](../images//11月/11-01/8.png){width=600px}

![11019](../images//11月/11-01/9.png){width=600px}

## node读写文件
![110110](../images//11月/11-01/10.png){width=600px}

## path模块 路径处理
![110111](../images//11月/11-01/11.png){width=600px}

![110112](../images//11月/11-01/12.png){width=600px}

## 压缩前端代码
![110113](../images//11月/11-01/13.png){width=600px}

## 压缩前端js到html中
![110114](../images//11月/11-01/14.png){width=600px}

![110115](../images//11月/11-01/15.png){width=600px}

## url端口号概念
![110116](../images//11月/11-01/16.png){width=600px}

![110117](../images//11月/11-01/17.png){width=600px}

![110118](../images//11月/11-01/18.png){width=600px}

## http模块-创建 Web 服务
![110119](../images//11月/11-01/19.png){width=600px}

## http模块-设置响应头 返回中文不会乱码
![110120](../images//11月/11-01/20.png){width=600px}

## 接口开发 返回数据 当一波后端
![110121](../images//11月/11-01/21.png){width=600px}

![110122](../images//11月/11-01/22.png){width=600px}

## Buffer对象、JSON字符串、字符串、JS对象 之间的转换关系
红色为常用的转换路线
![110123](../images//11月/11-01/23.png){width=600px}

## 浏览始终案例 可以导入html文件到指定的url网址中
![11041](../images//11月/11-04/1.png){width=600px}

## 压缩代码案例
![11042](../images//11月/11-04/2.png){width=600px}

## Node - Day2
![11062](../images//11月/11-06/2.png){width=600px}

我明白了 我还缺两张图片 

一张是 视频索引图片 一张是代码图片

等我刷完就开始大总结的适合就 搞上面两步

把上面两步做出来后还需要做一个思维导图

## 什么是模块化
index.js login.js。。。每一个文件都被是为单独的模块
![11043](../images//11月/11-04/3.png){width=600px}

在index.js中 引入了http模块 fs模块 path模块(内置的)

红色的js也是一个自己的一个模块

也可以依赖自己的模块 引入就可以了(自己定义的)
![11044](../images//11月/11-04/4.png){width=600px}

![11045](../images//11月/11-04/5.png){width=600px}

![11046](../images//11月/11-04/6.png){width=600px}

### CommonJS导出和导入
导入使用require('路径')

导出使用module.exports = {

    这两个导出的方法只是参考 可以自定义其他的
    baseURL: baseURL
    arraySum: getArraySum
}

## ECMAScript 标准 - 默认导出和导入
要求在utils.js 导出方法
index.js导入方法

Node.js默认不支持 ECMAScript语法 所以要支持 ECMAScript语法的话

需要在运行模块所在文件夹新建package.json文件，并设置{"type":"module"}
![11041](../images//11月/11-05/1.png){width=600px}

![11042](../images//11月/11-05/2.png){width=600px}

## ECMAScript - 命名导出和导入
就是按需加载 

可以按需加载和全局加载一起使用 不冲突 一般也是这样
![11043](../images//11月/11-05/3.png){width=600px}

![11044](../images//11月/11-05/4.png){width=600px}

## 包的概念
分为项目包和软件包

项目包 项目代码和逻辑

软件包 定义了工具和函数 将这些工具和函数给别的包使用

所以package.json必要

其中"main"为包的入口(导入utils包后导出全部模块的主文件)
![11045](../images//11月/11-05/5.png){width=600px}

![11046](../images//11月/11-05/6.png){width=600px}

![11047](../images//11月/11-05/7.png){width=600px}

## npm - 软件包管理器
自己的包别人用不到 所以需要托管出去 此时别人也会托管

所以我们就能使用别人的软件包 而软件包有很多管理器

其中一个就是npm包管理器

需要使用day.js软件包来 格式化日期时间

自己做需要使用getyear get... 其实有人已经做好 
所以只需要使用这些别人做好的包即可

在项目文件夹里 我们需要初始化一个清单文件 

这个文件就是package.json 使用npm init -y 生成

有了node 就有了npm

### 下包
使用 "npm install(i) 软件包名称" 命令

★注意在安装的过程中 不要去拖动黑窗口 不然可能出问题

然后npm就会去 npm 资源库中访问资源 并下载到项目中

然后在项目中生成一个node_modules 并放到这个文件中

比如我们要dayjs这个软件包 所以就会通过上面的流程
下载到node_modules中

同时在下载时 package.json会记录下载的文件并固化版本

并生成package-lock.json文件 这是一个固化版本文件

这个包就会固定dayjs的版本

### 使用
然后我们就可以在server.js中导入dayjs并使用了

注意 通过包管理器下载的 不用写路径
![11048](../images//11月/11-05/8.png){width=700px}

### package.json生成过程
使用 npm init -y生成

★注意初始化文件夹不能使用非英文名

如果没有使用 -y 那么就会问名称、版本、说明、等等信息
如果最后填不ok 那就会重新问名称那些

会很麻烦所以需要 -y 直接使用默认生成的信息
![11049](../images//11月/11-05/9.png){width=600px}

![110410](../images//11月/11-05/10.png){width=600px}

## 在缺失node_modules的情况下
根据package.json中的信息 安装所有插件
![110411](../images//11月/11-05/11.png){width=600px}

![110412](../images//11月/11-05/12.png){width=600px}

## npm - 全局软件包 nodemon
比如我们在06文件夹中的包 能在07中使用吗

是不能的 所以需要安装 nodemon
![110413](../images//11月/11-05/13.png){width=300px}

![110414](../images//11月/11-05/14.png){width=600px}

安装了两个包 一个dayjs 一个ladash
![110415](../images//11月/11-05/15.png){width=300px}

安装全局软件包nodemon的命令

注意npm i 写法固定 后面两个可以前可以后
![110416](../images//11月/11-05/16.png){width=600px}

### 热更新
可以发现执行了nodemon后 没有像node那样显示一些白色的东西
表示停掉 而是显示这些 表示热更新启动
![110417](../images//11月/11-05/17.png){width=400px}

只要修改完代码按下ctrl+s 就会自动更新控制台内容 不用重新启动
![110418](../images//11月/11-05/18.png){width=400px}

![110419](../images//11月/11-05/19.png){width=600px}

## Node.js 总结
默认Common.js规范 
![110420](../images//11月/11-05/20.png){width=600px}

![110421](../images//11月/11-05/21.png){width=600px}

删除全局软件包也是一样的

在npm uni 软件包名 -g 

加-g就可以了

uni 就是uninstall的意思
![110422](../images//11月/11-05/22.png){width=600px}

## Express框架
![110423](../images//11月/11-05/23.png){width=600px}

通过require('express')导入 因为是一个方法 
所以可以直接express() 而导出的server对象就可以使用其中的方法
![110424](../images//11月/11-05/24.png){width=600px}

## Express接口开发-省份列表
![110425](../images//11月/11-05/25.png){width=600px}

## 同源策略
例子:
钓鱼网站网页和银行一致 但是源不一致

此时同源策略就发挥作用

当钓鱼网站携带真实的信息发给银行服务器

银行服务器发现 源不一致 就会阻止登录
![110426](../images//11月/11-05/26.png){width=600px}

源 就是 协议、域名、端口 三者

当着三者不一致 就叫非同源 或者 跨域

在同源策略的影响下 还是刚刚那个例子 

所以当钓鱼网站发请求时 只能给自己发 无法向别人发
![110427](../images//11月/11-05/27.png){width=600px}

![110428](../images//11月/11-05/28.png){width=600px}

## 跨域问题
黑马文档里的接口 为什么请求回来不会跨域 因为他们做了操作

一般来说只要三者不一致就会跨域 导致请求失败 请求不回来东西
![110429](../images//11月/11-05/29.png){width=600px}

CORS就是跨域资源共享协议

两个文件 上面那个是服务端 下面的是客户端
![110430](../images//11月/11-05/30.png){width=300px}

## 服务端访问客户端 遇到的跨域问题
12 客户端
12 Web 服务端

遭遇到 CORS错误 就是跨域问题
![110431](../images//11月/11-05/31.png){width=600px}


![110432](../images//11月/11-05/32.png){width=300px}

![110433](../images//11月/11-05/33.png){width=300px}

![110434](../images//11月/11-05/34.png){width=300px}

就算
http://127.0.0.1:5500/%E8%AF%BE%E4%BB%B6/03-JavaScript/05-Node(1)/Node/Day02_Node.js%E6%A8%A1%E5%9D%97%E5%8C%96/03-code/12-Web/index.html
把 127.0.0.1 换成 localhost也不行 端口也不一样

## 跨域问题 解决方案1 - CORS
在服务端(后端) 使用cors软件包

它的原理还是给响应头增加了 一个响应字段
![110436](../images//11月/11-05/36.png){width=600px}

npm i cors下载这个包

并且在后端引入
![110437](../images//11月/11-05/37.png){width=600px}

可以看到在使用了cors之后 就会在响应头中添加这个字段
![110438](../images//11月/11-05/38.png){width=600px}

## 第二种解决办法是 直接加
![110439](../images//11月/11-05/39.png){width=600px}

### 以上两种方法都适合开发阶段 在上线阶段有更好的方法
![110440](../images//11月/11-05/40.png){width=600px}

## 跨域问题 解决方案2 同源访问
开发阶段可以用cors 但是上线后依然要关闭cors 并采取同源访问方式

把网页和接口整理起来的操作叫部署 后端干的
的方法
![110441](../images//11月/11-05/41.png){width=600px}

![110442](../images//11月/11-05/42.png){width=600px}

可以看到index.html的 Host: localhost:3000 和

province的 Host: localhost:3000 一致 说明是同源访问
![110443](../images//11月/11-05/43.png){width=600px}

![110444](../images//11月/11-05/44.png){width=600px}

### 常见的跨域请求
我们打开的网页是127.0.0.1 ... .html

而接口去访问数据的网址是https://hmajax.itheima.net

域名 端口 都不一样

而这两个不同源 所以就是跨域请求
![11061](../images//11月/11-06/1.png){width=600px}

还有一种是 前后端分离项目

前端干前端的活 后端干后端的活 是在两个不同的地方开发

两个地方开发意味着是两个服务器 所以就跨域了

所以这时就让后端开启跨域资源共享CORS来通信(开发阶段)

而上线阶段使用 同源访问 即协议端口域名三者一致 

这时可以访问数据资源 也可以访问网页资源 这时不算跨域 因为是同源的

在项目上线阶段不开启跨域 因为不安全 所以使用同源访问







